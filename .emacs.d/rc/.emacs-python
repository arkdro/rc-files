;; vim: ft=lisp
;; Lisp mode

(add-to-list 'load-path "~/.emacs.d/share/python-mode/")
(setq py-install-directory "~/.emacs.d/share/python-mode/")
(require 'python-mode)

(setq-default py-shell-name "ipython")
(setq-default py-which-bufname "IPython")

(setq py-force-py-shell-name-p t)

(setq py-shell-switch-buffers-on-execute-p t)
; switch to the interpreter after executing code
(setq py-switch-buffers-on-execute-p nil)
; don't split windows
(setq py-split-windows-on-execute-p nil)
; try to automagically figure out indentation
(setq py-smart-indentation t)

(custom-set-faces
  ; M-x customize-face RET py-TAB
 '(py-variable-name-face ((t (:foreground "blue"))))
 '(py-number-face ((t (:foreground "pink")))))

(add-to-list 'load-path "~/.emacs.d/share/jedi")
(add-to-list 'load-path "~/.emacs.d/share/jedi/jedi-0.1.2")

;; emacs rpc
(require 'epc)

;; auto complete
(require 'auto-complete)
(require 'auto-complete-config)
(add-to-list 'ac-dictionary-directories "~/.emacs.d/share/jedi/dict")
(ac-config-default)
(setq global-auto-complete-mode t)

;; jedi
(setq jedi:setup-keys t)
(setq jedi:complete-on-dot t)
(autoload 'jedi:setup "jedi" nil t)
(add-hook 'python-mode-hook 'jedi:setup)

;; python modes redefines C-Backspace to py-hungry-delete-backwards.
;; And this new C-Backspace is hungry for spaces only.
(add-hook 'python-mode-hook (lambda ()
                              (define-key python-mode-map
                                          (kbd "<C-backspace>")
                                          'backward-kill-word)
                              ))
;; unification
(add-hook 'python-mode-hook (lambda ()
                              (local-set-key (kbd "M-.") 'jedi:goto-definition)
                              (local-set-key (kbd "M-,") 'jedi:goto-definition-pop-marker)
                              ))
